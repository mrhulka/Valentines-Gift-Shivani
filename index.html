<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Our Symphony | Valentine 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600&family=Playfair+Display:ital,wght@0,600;1,600&family=Dancing+Script:wght@700&display=swap');
        
        :root {
            --valentine-yellow: #fdd835; 
            --valentine-red: #ff4d4d;
        }

        html, body {
            position: fixed;
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #000;
            font-family: 'Plus Jakarta Sans', sans-serif;
            color: #fff;
            -webkit-user-select: none;
            user-select: none;
            touch-action: none;
        }

        .font-serif { font-family: 'Playfair Display', serif; }
        .font-curvy { font-family: 'Dancing Script', cursive; }

        /* Landing Layer */
        .layer {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            background-color: var(--valentine-yellow);
            color: #000;
            visibility: visible;
            opacity: 1;
        }

        .layer.hidden-state {
            opacity: 0;
            visibility: hidden;
            transform: scale(1.1);
        }

        /* Heart Button */
        .heart-trigger { 
            background: var(--valentine-red); 
            color: #fff; 
            box-shadow: 0 10px 40px rgba(255, 77, 77, 0.5); 
            transition: transform 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            outline: none;
            -webkit-tap-highlight-color: transparent;
            animation: heartPulse 2s infinite;
        }
        
        @keyframes heartPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Main Player Shell */
        #player-container {
            position: absolute;
            inset: 0;
            background: #000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.8s ease;
            z-index: 10;
        }

        #player-container.active {
            opacity: 1;
            visibility: visible;
        }

        #reel-viewport {
            height: 100%;
            width: 100%;
            transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1);
            display: flex;
            flex-direction: column;
        }

        .reel-slide {
            height: 100vh;
            width: 100vw;
            flex-shrink: 0;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* 1:1 Photo Container */
        .album-art-container {
            aspect-ratio: 1 / 1;
            width: 85vw;
            max-width: 380px;
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 40px 80px -15px rgba(0, 0, 0, 0.9);
            margin: 0 auto;
            background: #111;
        }

        .album-art-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .blur-bg {
            position: absolute;
            inset: -50px;
            background-size: cover;
            background-position: center;
            filter: blur(60px) brightness(0.25);
            z-index: -1;
            transform: scale(1.3);
            transition: opacity 1.2s ease;
        }

        /* Visualizer */
        .bars-container {
            display: flex;
            align-items: flex-end;
            gap: 3px;
            height: 18px;
        }
        .bar {
            width: 3px;
            background: #fff;
            border-radius: 10px;
            animation: bounce 0.6s ease-in-out infinite alternate;
        }
        @keyframes bounce { 0% { height: 4px; } 100% { height: 18px; } }

        .yellow-theme { background-color: var(--valentine-yellow); color: #000; }
    </style>
</head>
<body>

    <!-- Landing Page -->
    <div id="landing-layer" class="layer text-center p-8">
        <div class="w-full max-w-[340px]">
            <h1 class="text-6xl font-curvy mb-4 leading-tight">For My<br>Forever<br>Valentine</h1>
            <p class="text-[10px] tracking-[0.5em] uppercase mb-16 font-bold opacity-60">tap the heart to enter</p>
            <button onclick="startExperience()" class="heart-trigger w-32 h-32 rounded-full mx-auto">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-16 h-16 fill-current" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
            </button>
        </div>
    </div>

    <!-- Main Player Container -->
    <div id="player-container">
        <div id="reel-viewport"></div>

        <!-- Floating UI -->
        <div class="fixed top-0 left-0 right-0 p-6 flex justify-between items-center z-50 pointer-events-none pt-[calc(24px+env(safe-area-inset-top))]">
            <div class="flex items-center gap-3">
                <div class="bars-container" id="visualizer">
                    <div class="bar" style="animation-delay: 0s"></div>
                    <div class="bar" style="animation-delay: 0.2s"></div>
                    <div class="bar" style="animation-delay: 0.4s"></div>
                </div>
                <div class="text-[9px] tracking-[0.4em] uppercase text-white/50 font-bold">Our Symphony</div>
            </div>
            <div id="counter" class="text-[10px] tracking-[0.1em] text-white/90 bg-white/10 px-4 py-2 rounded-full backdrop-blur-3xl border border-white/10">1 / 6</div>
        </div>
    </div>

    <audio id="main-audio" preload="auto"></audio>

    <script>
        const galleryData = [
            { text: "Where it all began" },
            { text: "Our favorite melody" },
            { text: "In every heartbeat" },
            { text: "The rhythm of us" },
            { text: "Always in tune" }
        ];

        let currentIndex = 0;
        const audioPlayer = document.getElementById('main-audio');

        function createSlides() {
            const viewport = document.getElementById('reel-viewport');
            
            // Photo Slides
            galleryData.forEach((item, index) => {
                const slide = document.createElement('div');
                slide.className = 'reel-slide';
                slide.innerHTML = `
                    <div class="blur-bg" id="blur-${index}"></div>
                    <div class="flex-1 flex flex-col items-center justify-center">
                        <div class="album-art-container">
                            <img id="photo-${index}" class="opacity-0 transition-opacity duration-1000" alt="Memory">
                            <div id="loader-${index}" class="absolute inset-0 flex items-center justify-center">
                                <div class="w-8 h-8 border-2 border-white/20 border-t-white rounded-full animate-spin"></div>
                            </div>
                        </div>
                        <div class="mt-12 text-center px-10">
                             <p class="text-white text-2xl font-curvy leading-relaxed">${item.text}</p>
                        </div>
                    </div>
                `;
                viewport.appendChild(slide);
            });

            // End Slides (Page 7 & 8 from your flow)
            const endSlide = document.createElement('div');
            endSlide.className = 'reel-slide yellow-theme';
            endSlide.innerHTML = `
                <div class="flex-1 flex flex-col items-center justify-center px-12 text-center">
                    <p class="text-3xl font-serif italic mb-2 tracking-tight">TO MANY MORE</p>
                    <p class="text-4xl font-curvy mb-4">Memories</p>
                    <p class="text-2xl font-serif italic mb-2 tracking-tight">TO LIVING MANY MORE</p>
                    <h1 class="text-6xl font-curvy">Songs</h1>
                </div>
            `;
            viewport.appendChild(endSlide);

            const finalSlide = document.createElement('div');
            finalSlide.className = 'reel-slide yellow-theme';
            finalSlide.innerHTML = `
                <div class="flex-1 flex flex-col items-center justify-center px-12 text-center">
                    <h1 class="text-5xl font-curvy mb-6 leading-tight">Happy<br>Valentines<br>Day My Love</h1>
                    <div class="mt-20 opacity-30 text-[10px] uppercase tracking-[0.5em] font-bold">Forever & Always</div>
                </div>
            `;
            viewport.appendChild(finalSlide);
            
            updateCounter();
        }

        function updateCounter() {
            const counter = document.getElementById('counter');
            if(counter) counter.innerText = `${currentIndex + 1} / ${galleryData.length + 2}`;
        }

        function playTrack(index) {
            if (index < 0 || index >= galleryData.length) {
                audioPlayer.pause();
                document.getElementById('visualizer').style.opacity = '0';
                return;
            }

            document.getElementById('visualizer').style.opacity = '1';
            audioPlayer.src = `songs/${index + 1}.mp3`;
            audioPlayer.play().catch(e => console.warn("Audio needs user interaction first"));
        }

        function loadSlideMedia(index) {
            if (index < 0 || index >= galleryData.length) return;
            const img = document.getElementById(`photo-${index}`);
            const loader = document.getElementById(`loader-${index}`);
            const blur = document.getElementById(`blur-${index}`);
            
            if (img && (!img.src || img.src.includes(window.location.hostname))) {
                const extensions = ['.jpg', '.JPG', '.jpeg', '.JPEG', '.png', '.webp'];
                let extIdx = 0;

                const tryLoad = () => {
                    if (extIdx >= extensions.length) {
                        img.src = "https://images.unsplash.com/photo-1518193582231-507981da40b2?auto=format&fit=crop&w=1000";
                        if(loader) loader.classList.add('hidden');
                        img.style.opacity = '1';
                        return;
                    }
                    const src = `images/Photo ${index + 1}${extensions[extIdx]}`;
                    const tester = new Image();
                    tester.onload = () => {
                        img.src = src;
                        if(blur) blur.style.backgroundImage = `url('${src}')`;
                        img.style.opacity = '1';
                        if(loader) loader.classList.add('hidden');
                    };
                    tester.onerror = () => {
                        extIdx++;
                        tryLoad();
                    };
                    tester.src = src;
                };
                tryLoad();
            }
        }

        function startExperience() {
            audioPlayer.play().then(() => {
                audioPlayer.pause();
                doTransition();
            }).catch(() => {
                doTransition();
            });
        }

        function doTransition() {
            document.getElementById('landing-layer').classList.add('hidden-state');
            document.getElementById('player-container').classList.add('active');
            
            setTimeout(() => {
                loadSlideMedia(0);
                playTrack(0);
            }, 300);
        }

        function scrollReel(dir) {
            const totalSlides = galleryData.length + 2;
            const next = currentIndex + dir;
            if (next >= 0 && next < totalSlides) {
                currentIndex = next;
                document.getElementById('reel-viewport').style.transform = `translateY(-${currentIndex * 100}%)`;
                updateCounter();
                playTrack(currentIndex);
                loadSlideMedia(currentIndex);
                loadSlideMedia(currentIndex + 1);
            }
        }

        let touchStartY = 0;
        document.addEventListener('touchstart', e => { touchStartY = e.touches[0].clientY; }, {passive: true});
        document.addEventListener('touchend', e => {
            const delta = touchStartY - e.changedTouches[0].clientY;
            if (Math.abs(delta) > 50) {
                scrollReel(delta > 0 ? 1 : -1);
            }
        });

        window.onload = createSlides;
    </script>
</body>
</html>
