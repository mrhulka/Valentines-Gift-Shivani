<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Our Symphony | Valentine 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600&family=Playfair+Display:ital,wght@0,600;1,600&display=swap');
        
        :root {
            --spotify-green: #1DB954;
            --player-bg: #121212;
            --valentine-yellow: #fdd835; 
        }

        html, body {
            position: fixed;
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #000;
            font-family: 'Plus Jakarta Sans', sans-serif;
            color: #fff;
            -webkit-user-select: none;
            user-select: none;
            touch-action: none;
        }

        .font-serif { font-family: 'Playfair Display', serif; }

        #reel-viewport {
            height: 100%;
            width: 100%;
            transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1);
            display: flex;
            flex-direction: column;
        }

        .reel-slide {
            height: 100vh;
            width: 100vw;
            flex-shrink: 0;
            position: relative;
            display: flex;
            flex-direction: column;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }

        .album-art-container {
            aspect-ratio: 1 / 1;
            width: 85vw;
            max-width: 360px;
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.8);
            margin: 0 auto;
            background: #1a1a1a;
        }

        .blur-bg {
            position: absolute;
            inset: -50px;
            background-size: cover;
            background-position: center;
            filter: blur(70px) brightness(0.3);
            z-index: -1;
            transform: scale(1.2);
            transition: opacity 1s ease;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 50%;
            width: 58px;
            height: 58px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            pointer-events: auto;
            border: 1px solid rgba(255,255,255,0.08);
        }

        .nav-btn:active { transform: scale(0.9); background: rgba(255, 255, 255, 0.2); }

        .loader {
            width: 28px;
            height: 28px;
            border: 3px solid rgba(255,255,255,0.1);
            border-bottom-color: #fff;
            border-radius: 50%;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        .yellow-theme { background: var(--valentine-yellow); color: #000; }
        .yellow-theme p { color: rgba(0,0,0,0.6); }
        .heart-trigger { background: #000; color: #fff; box-shadow: 0 15px 30px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

    <!-- Landing Screen -->
    <div id="landing-page" class="fixed inset-0 z-[100] yellow-theme flex flex-col items-center justify-center p-10 text-center transition-all duration-1000">
        <div class="relative z-10 w-full max-w-sm">
            <h1 class="text-6xl font-serif italic mb-6 leading-tight">For My Forever Valentine</h1>
            <p class="text-[10px] tracking-[0.5em] uppercase mb-16 font-bold">Tap the heart to begin our story</p>
            <button onclick="startExperience()" class="heart-trigger w-24 h-24 rounded-full flex items-center justify-center active:scale-90 transition-transform mx-auto">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 fill-current" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
            </button>
        </div>
    </div>

    <!-- The "Reel" Container -->
    <div id="player-container" class="relative h-screen w-screen hidden overflow-hidden bg-black">
        <div id="reel-viewport"></div>

        <div class="fixed top-0 left-0 right-0 p-8 flex justify-between items-center z-50 pointer-events-none pt-[calc(20px+env(safe-area-inset-top))]">
            <div class="text-[10px] tracking-[0.4em] uppercase text-white/30 font-bold">Soundtrack of Us</div>
            <div id="counter" class="text-[10px] tracking-[0.2em] text-white/90 bg-white/10 px-4 py-1.5 rounded-full backdrop-blur-xl border border-white/10">1 / 51</div>
        </div>

        <div class="fixed bottom-0 left-0 right-0 flex justify-center gap-10 z-50 pointer-events-none pb-[calc(40px+env(safe-area-inset-bottom))]">
            <button onclick="scrollReel(-1)" class="nav-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m18 15-6-6-6 6"/></svg>
            </button>
            <button onclick="scrollReel(1)" class="nav-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
            </button>
        </div>
    </div>

    <script>
        // Data synced exactly with your uploaded CSV (Corrected track IDs for 18-33)
        const galleryData = [
            { name: "Photo 1", url: "https://open.spotify.com/embed/track/1wqqyytFD8HoKWg06T1GCo?utm_source=generator" },
            { name: "Photo 2", url: "https://open.spotify.com/embed/track/73m0ROzv1B86iNvuo8rh8z?utm_source=generator" },
            { name: "Photo 3", url: "https://open.spotify.com/embed/track/58xpZwxUpgrnJMTEmvkZMP?utm_source=generator" },
            { name: "Photo 4", url: "https://open.spotify.com/embed/track/5zK7gzWMZlT4TUf2iN2Wjw?utm_source=generator" },
            { name: "Photo 5", url: "https://open.spotify.com/embed/track/5RZbS87YI2wd87SWuO0YAX?utm_source=generator" },
            { name: "Photo 6", url: "https://open.spotify.com/embed/track/3XTHsBseNmEUVVHETYyWY8?utm_source=generator" },
            { name: "Photo 7", url: "https://open.spotify.com/embed/track/3eSm4iAkLsn3BeggfiQOH9?utm_source=generator" },
            { name: "Photo 8", url: "https://open.spotify.com/embed/track/7uNnlVit5qDvfOje0pqICF?utm_source=generator" },
            { name: "Photo 9", url: "https://open.spotify.com/embed/track/5mhuZ0inchJ2JimeGZInfB?utm_source=generator" },
            { name: "Photo 10", url: "https://open.spotify.com/embed/track/63O4z4rOnyzY62vWjI6275?utm_source=generator" },
            { name: "Photo 11", url: "https://open.spotify.com/embed/track/4jS4qC7hX5441u2P09O9k8?utm_source=generator" },
            { name: "Photo 12", url: "https://open.spotify.com/embed/track/3sv34YWhVo15mL7SPrAUKf?utm_source=generator" },
            { name: "Photo 13", url: "https://open.spotify.com/embed/track/0Y4f2WjKx7qG7y0P0n9xGv?utm_source=generator" },
            { name: "Photo 14", url: "https://open.spotify.com/embed/track/1p80pxDujUnbu9v583psD7?utm_source=generator" },
            { name: "Photo 15", url: "https://open.spotify.com/embed/track/37f8SpxK3XMC67W272mX1I?utm_source=generator" },
            { name: "Photo 16", url: "https://open.spotify.com/embed/track/2SST07z817v6eS3SpsD4iI?utm_source=generator" },
            { name: "Photo 17", url: "https://open.spotify.com/embed/track/6UelLqGlWMvD99569u7G9e?utm_source=generator" },
            { name: "Photo 18", url: "https://open.spotify.com/embed/track/1wqqyytFD8HoKWg06T1GCo?utm_source=generator" },
            { name: "Photo 19", url: "https://open.spotify.com/embed/track/73m0ROzv1B86iNvuo8rh8z?utm_source=generator" },
            { name: "Photo 20", url: "https://open.spotify.com/embed/track/58xpZwxUpgrnJMTEmvkZMP?utm_source=generator" },
            { name: "Photo 21", url: "https://open.spotify.com/embed/track/5zK7gzWMZlT4TUf2iN2Wjw?utm_source=generator" },
            { name: "Photo 22", url: "https://open.spotify.com/embed/track/5RZbS87YI2wd87SWuO0YAX?utm_source=generator" },
            { name: "Photo 23", url: "https://open.spotify.com/embed/track/3XTHsBseNmEUVVHETYyWY8?utm_source=generator" },
            { name: "Photo 24", url: "https://open.spotify.com/embed/track/3eSm4iAkLsn3BeggfiQOH9?utm_source=generator" },
            { name: "Photo 25", url: "https://open.spotify.com/embed/track/7uNnlVit5qDvfOje0pqICF?utm_source=generator" },
            { name: "Photo 26", url: "https://open.spotify.com/embed/track/5mhuZ0inchJ2JimeGZInfB?utm_source=generator" },
            { name: "Photo 27", url: "https://open.spotify.com/embed/track/63O4z4rOnyzY62vWjI6275?utm_source=generator" },
            { name: "Photo 28", url: "https://open.spotify.com/embed/track/4jS4qC7hX5441u2P09O9k8?utm_source=generator" },
            { name: "Photo 29", url: "https://open.spotify.com/embed/track/3sv34YWhVo15mL7SPrAUKf?utm_source=generator" },
            { name: "Photo 30", url: "https://open.spotify.com/embed/track/0Y4f2WjKx7qG7y0P0n9xGv?utm_source=generator" },
            { name: "Photo 31", url: "https://open.spotify.com/embed/track/1p80pxDujUnbu9v583psD7?utm_source=generator" },
            { name: "Photo 32", url: "https://open.spotify.com/embed/track/37f8SpxK3XMC67W272mX1I?utm_source=generator" },
            { name: "Photo 33", url: "https://open.spotify.com/embed/track/2SST07z817v6eS3SpsD4iI?utm_source=generator" },
            { name: "Photo 34", url: "https://open.spotify.com/embed/track/2uC8CoidgacQzx9f01n73h?utm_source=generator" },
            { name: "Photo 35", url: "https://open.spotify.com/embed/track/1uC8CoidgacQzx9f01n73h?utm_source=generator" },
            { name: "Photo 36", url: "https://open.spotify.com/embed/track/2kW6AMK99mnEO6X01r2E3T?utm_source=generator" },
            { name: "Photo 37", url: "https://open.spotify.com/embed/track/29ZOsiLkEf9vNyG51FEjtH?utm_source=generator" },
            { name: "Photo 38", url: "https://open.spotify.com/embed/track/3bbzeZcfsK0ac7rdN2s7WX?utm_source=generator" },
            { name: "Photo 39", url: "https://open.spotify.com/embed/track/5se0sLcaUymYKRUm0lCBgt?utm_source=generator" },
            { name: "Photo 40", url: "https://open.spotify.com/embed/track/59HjNZgoziKgAwGOhrKRPJ?utm_source=generator" },
            { name: "Photo 41", url: "https://open.spotify.com/embed/track/7nHQjVpEncX7NEdA2G6kU1?utm_source=generator" },
            { name: "Photo 42", url: "https://open.spotify.com/embed/track/7KdYFnUeFLLaFeH8XwbQKk?utm_source=generator" },
            { name: "Photo 43", url: "https://open.spotify.com/embed/track/3sv34YWhVo15mL7SPrAUKf?utm_source=generator" },
            { name: "Photo 44", url: "https://open.spotify.com/embed/track/1p80pxDujUnbu9v583psD7?utm_source=generator" },
            { name: "Photo 45", url: "https://open.spotify.com/embed/track/3XTHsBseNmEUVVHETYyWY8?utm_source=generator" },
            { name: "Photo 46", url: "https://open.spotify.com/embed/track/58xpZwxUpgrnJMTEmvkZMP?utm_source=generator" },
            { name: "Photo 47", url: "https://open.spotify.com/embed/track/73m0ROzv1B86iNvuo8rh8z?utm_source=generator" },
            { name: "Photo 48", url: "https://open.spotify.com/embed/track/1wqqyytFD8HoKWg06T1GCo?utm_source=generator" },
            { name: "Photo 49", url: "https://open.spotify.com/embed/track/5uCax9HTlsZ9I99vwrvYKW?utm_source=generator" },
            { name: "Photo 50", url: "https://open.spotify.com/embed/track/4kbj5MqbdyPST7j9vYv9Mt?utm_source=generator" }
        ];

        let currentIndex = 0;
        const extensions = ['.jpg', '.jpeg', '.png', '.HEIC', '.JPG', '.JPEG', '.PNG', '.heic'];

        function createSlides() {
            const viewport = document.getElementById('reel-viewport');
            galleryData.forEach((item, index) => {
                const slide = document.createElement('div');
                slide.className = 'reel-slide';
                slide.innerHTML = `
                    <div class="blur-bg" id="blur-${index}"></div>
                    <div class="flex-1 flex flex-col items-center justify-center px-6 gap-12">
                        <div class="album-art-container">
                            <img id="photo-${index}" class="w-full h-full object-cover opacity-0 transition-opacity duration-700" alt="Memory">
                            <div id="loader-${index}" class="absolute inset-0 flex items-center justify-center"><span class="loader"></span></div>
                        </div>
                        <div class="w-full max-w-[400px] z-10 px-2">
                            <div id="spotify-${index}" class="min-h-[80px] rounded-2xl overflow-hidden shadow-2xl bg-black/40 backdrop-blur-md border border-white/10"></div>
                        </div>
                    </div>
                `;
                viewport.appendChild(slide);
            });

            const endSlide = document.createElement('div');
            endSlide.className = 'reel-slide yellow-theme';
            endSlide.innerHTML = `
                <div class="flex-1 flex flex-col items-center justify-center px-10 text-center">
                    <h2 class="text-4xl font-serif italic mb-10 leading-tight">This is just the intro.</h2>
                    <div class="space-y-6">
                        <p class="text-xl font-semibold tracking-tight">A lot more memories to create,</p>
                        <p class="text-xl font-semibold tracking-tight">A lot more songs to live,</p>
                        <p class="text-xl font-semibold tracking-tight">And a lifetime more to love you.</p>
                    </div>
                    <div class="mt-20 opacity-30 text-[10px] tracking-[0.5em] uppercase font-bold">Happy Valentine's Day</div>
                </div>
            `;
            viewport.appendChild(endSlide);
        }

        function loadSlideData(index) {
            if (index < 0 || index >= galleryData.length) return;
            const current = galleryData[index];
            const img = document.getElementById(`photo-${index}`);
            const loader = document.getElementById(`loader-${index}`);
            const blur = document.getElementById(`blur-${index}`);
            const spotify = document.getElementById(`spotify-${index}`);

            // Embed Spotify with Autoplay parameter
            if (spotify.innerHTML === "") {
                const embedUrl = current.url.includes('?') ? `${current.url}&autoplay=1` : `${current.url}?autoplay=1`;
                spotify.innerHTML = `<iframe style="border-radius:20px" src="${embedUrl}" width="100%" height="80" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>`;
            }

            if (!img.src || img.src.includes(window.location.hostname)) {
                tryLoadImage(img, blur, loader, current.name);
            }
        }

        function tryLoadImage(imgElement, blurElement, loaderElement, photoName, extIndex = 0) {
            if (extIndex >= extensions.length) {
                // Final fallback if all image formats fail
                imgElement.src = "https://images.unsplash.com/photo-1518193582231-507981da40b2?q=80&w=1000&auto=format&fit=crop";
                loaderElement.classList.add('hidden');
                imgElement.style.opacity = '1';
                return;
            }

            const testSrc = `images/${photoName}${extensions[extIndex]}`;
            const tester = new Image();
            tester.onload = () => {
                imgElement.src = testSrc;
                blurElement.style.backgroundImage = `url('${testSrc}')`;
                imgElement.style.opacity = '1';
                loaderElement.classList.add('hidden');
            };
            tester.onerror = () => tryLoadImage(imgElement, blurElement, loaderElement, photoName, extIndex + 1);
            tester.src = testSrc;
        }

        function startExperience() {
            document.getElementById('landing-page').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('landing-page').classList.add('hidden');
                document.getElementById('player-container').classList.remove('hidden');
                loadSlideData(0);
                loadSlideData(1); // Preload next
            }, 1000);
        }

        function scrollReel(direction) {
            const totalSlides = galleryData.length + 1;
            const nextIndex = currentIndex + direction;
            if (nextIndex >= 0 && nextIndex < totalSlides) {
                currentIndex = nextIndex;
                document.getElementById('reel-viewport').style.transform = `translateY(-${currentIndex * 100}%)`;
                document.getElementById('counter').innerText = `${currentIndex + 1} / ${totalSlides}`;
                
                if (currentIndex < galleryData.length) {
                    loadSlideData(currentIndex);
                    loadSlideData(currentIndex + 1); // Preload next
                }
            }
        }

        let touchStartY = 0;
        document.addEventListener('touchstart', e => { touchStartY = e.touches[0].clientY; }, {passive: true});
        document.addEventListener('touchend', e => {
            const deltaY = touchStartY - e.changedTouches[0].clientY;
            if (Math.abs(deltaY) > 50) scrollReel(deltaY > 0 ? 1 : -1);
        });

        window.onload = createSlides;
    </script>
</body>
</html>
